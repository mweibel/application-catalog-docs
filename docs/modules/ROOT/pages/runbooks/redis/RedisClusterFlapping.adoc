= Alert rule: RedisClusterFlapping

== icon:glasses[] Overview

Checks if there are more than a defined amount of connection changes for connected slaves over 5 minutes.
If this is the case, this alert will be executed.

[source,yaml]
----
- alert: RedisClusterFlapping
  expr: |
    changes(redis_connected_slaves[5m]) > 2
  for: 5m
  labels:
    severity: critical
  annotations:
    summary: Redis cluster flapping (instance {{ $labels.instance }})
    description: |
      Changes have been detected in Redis replica connection. This can occur when replica nodes lose connection to the master and reconnect (a.k.a flapping).\n  VALUE = {{ $value }}\n  LABELS: {{ $labels }}
----

== icon:bug[] Steps for Debugging

Check why there are always disconnections and reconnections between master and slaves.
Check the log files of the Redis Pods to see messages about loosing connections.
